---
title: Where's the nearest Taco Bell
author: Matt Leary
date: 2019-05-05
categories: ["R"]
tags: ["Geocoding"]
thumbnailImage: /img/taco_bell.png
thumbnailImagePosition: left
summary: Experimenting with geocoding & working with spatial data (and ultimately finding the nearest taco bell)
draft: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```


I had a classmate named Will who **loved** Taco Bell.  He once gave a presentation about the virtues of Taco Bell and the comapnies history.  It was both informative and brilliant.

Years later I was working on a project that involved geospatial data and geocoding addresses.  As I started to read up about the process 

![Taco Bell's in Atlanta in honor of Will](/img/taco_bell.png)



```{r,  warning=FALSE}

library(googleway)
library(geosphere)
library(tidyverse)


nearest_locations <- function(address, location_type) {
  
  latlon <- google_geocode(address = address,
                 key = apiKey,
                 simplify = TRUE)

  results <- google_places(search_string = as.character(location_type),
                location = c(latlon$results$geometry$location$lat,
                             latlon$results$geometry$location$lng),
                radius = 50000,
                key = apiKey) 
  
  results <- as.data.frame(results$result[,c(1,2,5)]) 
  
  dist <- distm(data.frame(results$geometry$location$lng,
                           results$geometry$location$lat),
                          c(latlon$results$geometry$location$lng,
                            latlon$results$geometry$location$lat))  / 1609.34

  results <- cbind(results %>% select(name ,formatted_address),
                   dist) %>% 
                  arrange(dist)
  
  results 
  
  return(results)
  
}
```

